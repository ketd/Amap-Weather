{
  "schema_version": "1.0",
  "id": "amap-weather-prefab",
  "version": "1.0.0",
  "name": "高德地图天气查询预制件",
  "description": "基于高德地图 API 的天气查询预制件，支持实时天气和天气预报查询",
  "tags": [
    "weather",
    "amap",
    "gaode",
    "china",
    "forecast"
  ],
  "entry_point": "src/main.py",
  "dependencies_file": "pyproject.toml",
  "functions": [
    {
      "name": "get_weather",
      "description": "通过城市名称查询实时天气或天气预报",
      "parameters": [
        {
          "name": "city_name",
          "type": "string",
          "description": "城市名称，例如 '北京市'、'东城区'、'上海市'、'杭州' 等。支持模糊匹配，可以省略'市'、'区'、'县'等后缀",
          "required": true
        },
        {
          "name": "extensions",
          "type": "string",
          "description": "气象类型：'base' 返回实况天气（默认），'all' 返回预报天气（未来3-4天）",
          "required": false,
          "default": "base",
          "enum": ["base", "all"]
        }
      ],
      "returns": {
        "type": "object",
        "description": "包含天气信息的对象",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "操作是否成功"
          },
          "type": {
            "type": "string",
            "description": "查询类型：'live' 表示实况天气，'forecast' 表示预报天气（成功时）",
            "optional": true,
            "enum": ["live", "forecast"]
          },
          "city_name": {
            "type": "string",
            "description": "城市名称（成功时）",
            "optional": true
          },
          "data": {
            "type": "object",
            "description": "天气数据对象（成功时）",
            "optional": true,
            "properties": {
              "province": {
                "type": "string",
                "description": "省份名称"
              },
              "city": {
                "type": "string",
                "description": "城市名称"
              },
              "adcode": {
                "type": "string",
                "description": "区域编码"
              },
              "weather": {
                "type": "string",
                "description": "天气现象（实况天气）",
                "optional": true
              },
              "temperature": {
                "type": "string",
                "description": "实时气温，单位：摄氏度（实况天气）",
                "optional": true
              },
              "winddirection": {
                "type": "string",
                "description": "风向描述（实况天气）",
                "optional": true
              },
              "windpower": {
                "type": "string",
                "description": "风力级别，单位：级（实况天气）",
                "optional": true
              },
              "humidity": {
                "type": "string",
                "description": "空气湿度（实况天气）",
                "optional": true
              },
              "reporttime": {
                "type": "string",
                "description": "数据发布的时间"
              },
              "casts": {
                "type": "array",
                "description": "预报数据列表（预报天气）",
                "optional": true,
                "items": {
                  "type": "object",
                  "properties": {
                    "date": {
                      "type": "string",
                      "description": "日期"
                    },
                    "week": {
                      "type": "string",
                      "description": "星期几"
                    },
                    "dayweather": {
                      "type": "string",
                      "description": "白天天气现象"
                    },
                    "nightweather": {
                      "type": "string",
                      "description": "晚上天气现象"
                    },
                    "daytemp": {
                      "type": "string",
                      "description": "白天温度"
                    },
                    "nighttemp": {
                      "type": "string",
                      "description": "晚上温度"
                    },
                    "daywind": {
                      "type": "string",
                      "description": "白天风向"
                    },
                    "nightwind": {
                      "type": "string",
                      "description": "晚上风向"
                    },
                    "daypower": {
                      "type": "string",
                      "description": "白天风力"
                    },
                    "nightpower": {
                      "type": "string",
                      "description": "晚上风力"
                    }
                  }
                }
              }
            }
          },
          "error": {
            "type": "string",
            "description": "错误信息（失败时）",
            "optional": true
          },
          "error_code": {
            "type": "string",
            "description": "错误代码（失败时）",
            "optional": true,
            "enum": [
              "MISSING_API_KEY",
              "INVALID_CITY_NAME",
              "INVALID_EXTENSIONS",
              "CITY_DATA_ERROR",
              "CITY_NOT_FOUND",
              "API_ERROR",
              "NO_DATA",
              "TIMEOUT",
              "NETWORK_ERROR",
              "UNEXPECTED_ERROR"
            ]
          },
          "api_infocode": {
            "type": "string",
            "description": "高德地图 API 返回的错误码（API_ERROR 时）",
            "optional": true
          }
        }
      },
      "secrets": [
        {
          "name": "AMAP_API_KEY",
          "description": "高德地图 Web 服务 API Key",
          "instructions": "请访问高德地图开放平台（https://console.amap.com/dev/key/app）注册账号并创建应用，选择 'Web 服务' 类型，获取 API Key。",
          "required": true
        }
      ]
    }
  ],
  "execution_environment": {
    "cpu": "500m",
    "memory": "256Mi"
  }
}
